# Application
spring.application.name=user-service
server.port=7501
server.shutdown=graceful
spring.main.allow-bean-definition-overriding=true
spring.lifecycle.timeout-per-shutdown-phase=30s

# Logging
logging.level.root=INFO
logging.level.com.shikshaspace=DEBUG
logging.pattern.console=%d{yyyy-MM-dd HH:mm:ss} - %thread - %-5level %logger{36} - %msg%n

# R2DBC Database Configuration
spring.r2dbc.url=${R2DBC_URL:r2dbc:postgresql://localhost:5432/userdb}
spring.r2dbc.username=${DB_USERNAME:postgres}
spring.r2dbc.password=${DB_PASSWORD:postgres}
spring.r2dbc.pool.enabled=true
spring.r2dbc.pool.initial-size=10
spring.r2dbc.pool.max-size=50
spring.r2dbc.pool.max-idle-time=30m
spring.r2dbc.pool.max-acquire-time=3s
spring.r2dbc.pool.validation-query=SELECT 1

# Flyway Migration
spring.flyway.url=${FLYWAY_URL:jdbc:postgresql://localhost:5432/userdb}
spring.flyway.user=${DB_USERNAME:postgres}
spring.flyway.password=${DB_PASSWORD:postgres}
spring.flyway.enabled=true
spring.flyway.baseline-on-migrate=true
spring.flyway.locations=classpath:db/migration
spring.flyway.clean-disabled=true

# OAuth2 Resource Server (JWT)
spring.security.oauth2.resourceserver.jwt.issuer-uri=${KEYCLOAK_ISSUER_URI:http://localhost:8080/realms/shikshaspace}
spring.security.oauth2.resourceserver.jwt.jwk-set-uri=${KEYCLOAK_JWK_SET_URI:http://localhost:8080/realms/shikshaspace/protocol/openid-connect/certs}

# Keycloak Configuration
keycloak.server-url=${KEYCLOAK_SERVER_URL:http://localhost:8080}
keycloak.realm=${KEYCLOAK_REALM:shikshaspace}
keycloak.client-id=${KEYCLOAK_CLIENT_ID:shikshaspace-client}
keycloak.client-secret=${KEYCLOAK_CLIENT_SECRET:your-client-secret}
keycloak.admin.username=${KEYCLOAK_ADMIN_USERNAME:admin}
keycloak.admin.password=${KEYCLOAK_ADMIN_PASSWORD:admin}

# Actuator & Monitoring
management.endpoints.web.exposure.include=health,info,metrics,prometheus
management.endpoint.health.show-details=when-authorized
management.endpoint.health.probes.enabled=true
management.health.readinessState.enabled=true
management.health.livenessState.enabled=true
management.metrics.export.prometheus.enabled=true

# OpenAPI Documentation
springdoc.api-docs.path=/v3/api-docs
springdoc.swagger-ui.path=/swagger-ui.html
springdoc.swagger-ui.enabled=true
